<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Аутентификация</title>
</head>
<body>
<h1>Регистрация</h1>
<form id="sign-up-form">
  <label>
    Имя пользователя:
    <input type="text" name="username" required>
  </label>
  <br>
  <label>
    Почта:
    <input type="email" name="email" required>
  </label>
  <br>
  <label>
    Пароль:
    <input type="password" name="password" required>
  </label>
  <br>
  <button type="submit">Зарегистрироваться</button>
</form>

<h1>Авторизация</h1>
<form id="sign-in-form">
  <label>
    Имя пользователя:
    <input type="text" name="username" required>
  </label>
  <br>
  <label>
    Пароль:
    <input type="password" name="password" required>
  </label>
  <br>
  <button type="submit">Войти</button>
</form>

<script>
  document.getElementById('sign-up-form').addEventListener('submit', async (event) => {
    event.preventDefault();
    const formData = new FormData(event.target);
    const response = await fetch('/api/v1/auth/sign-up', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        username: formData.get('username'),
        password: formData.get('password'),
        email: formData.get('email')
      }),
    });
    const data = await response.json();
    console.log(data);
  });

  document.getElementById('sign-in-form').addEventListener('submit', async (event) => {
    event.preventDefault();
    const formData = new FormData(event.target);
    const response = await fetch('api/v1/auth/sign-in', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        username: formData.get('username'),
        password: formData.get('password'),
      }),
    });
    const data = await response.json();

    // Сохранить JWT-токен в куки
    document.cookie = `Authorization=Bearer ${data.token}; max-age=${60 * 60 * 24 * 7}; path=/; secure; HttpOnly`;

    console.log(data);
  });
</script>
</body>
</html>
